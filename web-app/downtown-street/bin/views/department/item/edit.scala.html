@(title: String, isLoggedIn: Boolean, editItemForm: Form[views.formdata.department.EditItemForm], categoryList: List[models.Category], tagId: Integer, logText: String, isApproved: Boolean, imagePath: String)

@import views.html.department._
@import helper._
@import views.html.bootstrap3._


@backend(title, isLoggedIn) {

	<div class="col-md-6">
	<h2><span class="glyphicon glyphicon-th-large"></span> @title <small> | Edit items to the inventory</small></h2>
	<hr>
	
		@form(routes.DepartmentController.updateItem(tagId), 'class -> "form-horizontal", 'enctype -> "multipart/form-data"){
	    
	    @number(editItemForm("tagId"),
        	label = "Tag ID",
        	placeholder = "Item Tag ID (required)",
        	help ="",
        	readOnly = isApproved
        	)
        	
        @text(editItemForm("name"),
        	label = "Name",
        	placeholder = "Item Name (required)",
        	help ="",
        	readOnly = isApproved
        	)
        	
       	@text(editItemForm("description"),
        	label = "Description",
        	placeholder = "Description if any (optional)",
        	help ="",
        	readOnly = isApproved)
       	
      	@text(editItemForm("serialNumber"),
        	label = "Serial Number",
        	placeholder = "Serial Number if any (optional)",
        	help ="",
        	readOnly = isApproved)
      
      
        	
       	@price(editItemForm("unitCost"),
        	label = "Unit Cost",
        	placeholder = "Item Unit Cost (required)",
        	help ="",
        	readOnly = isApproved)
       	
       	@number(editItemForm("quantity"),
        	label = "Quantity",
        	placeholder = "Item Quantity (default is 1)",
        	help ="",
        	isMinZero = false,
        	readOnly = isApproved)
        	
       	@text(editItemForm("location"),
        	label = "Location",
        	placeholder = "Item Location (optional)",
        	help ="",
        	readOnly = isApproved)
        	
       		
      	  <div class="form-group @if(editItemForm("categoryId").hasErrors) {has-error}">
		    <label class="col-sm-3 control-label" for="@editItemForm("categoryId").id">Category</label>
		    <div class="col-sm-9">
		      <select
		        class="form-control categories"
		        id="@editItemForm("categoryId").id"
		        name="@editItemForm("categoryId").name"
		        @if(isApproved){
		        	readonly = "readonly"
		        }
		        >
		        @for(category <- categoryList) {
		          <option id="@category.getCategoryName()" value="@category.getId()" @if(editItemForm("categoryId").value.toString() == (category.getId().toString())){selected }>@category.getCategoryName()</option>
		       
		        }
		        
		      </select>
		      
		      <span class="help-block">@{editItemForm("categoryId").error.map { error => error.message }}</span>
		    </div>
		  </div>
		  
		   @number(editItemForm("disposeQuantity"),
	        	label = "Dispose Quantity",
	        	placeholder = "Number of items disposed if any",
	        	isMinZero = true,
	        	readOnly = isApproved
        	)
		  
		  <div class="form-group @if(editItemForm("disposalDate").hasErrors) {has-error}">
		    <label class="col-sm-3 control-label">Disposal Date</label>
		    <div class="col-sm-9">
		    	<input 
		    		id="editItemForm("disposalDate").id" 
		    		type="date" 
		    		value="@editItemForm("disposalDate").value"
		    		class="form-control"
		    		name="@editItemForm("disposalDate").name"
		    		@if( isApproved ){
		    			readonly = "readonly"
		    		}
		    		placeholder="Leave blank for current date and time"
		    	/>
		    </div>
		  </div>
		
       	@text(editItemForm("otherInformation"),
        	label = "Other Information",
        	placeholder = "Other information not mentioned in the form (optional)",
        	help ="",
        	readOnly = isApproved
        	)
        	
       	<div class="form-group">
		    <label class="col-sm-3 control-label">Approval Status</label>
		    <div class="col-sm-9">
		    	@if(isApproved){
		    		<span class="label label-success">Approved Item</span>
		    	}else{
		    		<span class="label label-warning">Pending Approval</span>
		    	}
		    </div>
		  </div>
		  
		  <div class="form-group">
			    <label class="col-sm-3 control-label" for="picture">Picture</label>
			    <div class="col-sm-9">
			      @if(imagePath != null && imagePath.length() > 0){
			      	<img class="col-md-12 item-image" src="@routes.Assets.at("images/inventory-images/" + imagePath)"/>
			      	
			      	<div class="col-md-12">
			      		<hr/>
			      		<button type="button" id="remove-button" class="btn btn-danger">Remove Image</button>
			      		<button type="button" class="btn btn-default" data-toggle="modal" data-target="#image-modal">Open Full Image</button>
			      		<hr/>
			      	</div>
			      	
			      }else{
			      	<i>No picture</i>
			      }
			      
			      <input type="file" id="picture" name="picture" data-max-size='4m' accept="image/*" />
			      <span class="help-block">Upload a picture. 4MB max size(optional)</span>
			      <input type="text" hidden readonly name="imagePath" id="image-path" value="@imagePath">
			    </div>
		  </div>
	    	
	    	
	    	@if(!isApproved){
	    		<button type="submit" class="btn-default btn btn-primary pull-right">Update Item</button>
	    	}
       	
       	
        </div>
        <div class="row col-md-6 text-center log-container">
        <h2>Log History</h2>
        <hr/>
		    @Html(logText)
		</div>
	
	</div>		
	
	
	<div class="modal fade full-width-modal" id="image-modal" tabindex="-1" role="dialog" 
		   aria-labelledby="myModalLabel" aria-hidden="true">
		   <div class="modal-dialog">
		      <div class="modal-content">
		         <div class="modal-header">
		            <button type="button" class="close" 
		               data-dismiss="modal" aria-hidden="true">
		                  &times;
		            </button>
		            <h4 class="modal-title" id="myModalLabel">
		              Item Image
		            </h4>
		         </div>
		         <div class="modal-body text-center">
		            <img src="@routes.Assets.at("images/inventory-images/" + imagePath)" />
		         </div>
		         <div class="modal-footer">
		         </shr>
		         	<button type="button" class="btn btn-default" 
			               data-dismiss="modal">Close
			            </button>
		         </div>
		      </div><!-- /.modal-content -->
		  </div><!-- /.modal-dialog -->
		</div><!-- /.modal -->			
	}
	<script src="@routes.Assets.at("javascripts/file-validator.js")" type="text/javascript"></script>
	<script type="text/javascript">
	jQuery(document).ready(function() {
		  jQuery(".categories").select2();
		  jQuery( "input[type=file]" ).fileValidator({
			  onValidation: function(files){      $(this).attr('class','');          },
			  onInvalid:    function(type, file){ 
				  					$(this).addClass('invalid '+type); 
			  						jQuery("form").on("submit",function(){
			  							alert("File size is too big. Please use an image lesser than MB");
			  							return false;
			  						})
	  						},
			  maxSize:      '4m',
			  type:         'image' //optional
			});
		  
		  jQuery("#remove-button").click(function(){
			  jQuery("img.item-image").hide();
			  jQuery("#image-path").val("");
		  });
			
		});
	</script>
	 
}